---
- hosts: zabbix
  become: yes
  tasks:
  - name: "Check Old Version"
    command: zabbix_agentd -V
    register: old
  - name: "Result"
    debug:
      msg: "{{old}}"
  - name: "Update Repo Zabbix" 
    when: '"6.0." not in old'
    replace:
      path: /etc/yum.repos.d/zabbix.repo
      regexp: '\d.\d'
      replace: '/6.0/'
  - name: "Update ZAbbix Agent"
    when: '"6.0." not in old'
    ansible.builtin.yum:
      name: zabbix-agent
      enablerepo: zabbix
      state: present
